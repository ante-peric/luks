<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="LibreOffice 4.1.6.2 (Linux)">
	<META NAME="CREATED" CONTENT="20200921;143416960926316">
	<META NAME="CHANGED" CONTENT="20200923;130615149222870">
	<STYLE TYPE="text/css">
	<!--
		@page { size: 8.5in 11in; margin: 0.79in }
		P { margin-bottom: 0.1in; line-height: 115% }
		TD P { margin-bottom: 0in }
		A:link { so-language: zxx }
	-->
	</STYLE>
</HEAD>
	<h2><center>CaksSonicDeveloper© - Linux</center></h2>
	<hr style="color:#ffb380">
	<center>LUKS</center>
    <center>Linux Unified Key Setup - on - disk - format</center>
    <br>

	<hr style="color:#ffb380">
<center><p><a href="index.html">Početna</a></center> 
<hr style="color:#ffb380">
<BODY LANG="en-US" DIR="LTR">
<P STYLE="margin-bottom: 0in; line-height: 100%"><B>3.4.  Kreiranje
LUKS Particije – Primjer 3 </B>
</P>
<P STYLE="margin-bottom: 0in; line-height: 100%"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
U ovome dijelu kreirat ćemo:</P>
<UL>
	<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
	</P>
	<LI><P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
	particiju na USB tipa Linux, veličine 1024M</P>
</UL>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
</P>
<UL>
	<LI><P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
	nećemo imati file koji sadrži ključeve – /etc/luks-keys/</P>
	<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
	</P>
	<LI><P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
	Imat ćemo zapis u /etc/crypttab/</P>
	<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
	</P>
	<LI><P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
	I svaki put kad se sustav reboot – ručno će se unosti passphrase
	pri pokretanju boot menu</P>
</UL>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
Prikaz našeg USB – a.</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<TABLE WIDTH=100% CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=256*>
	<TR>
		<TD WIDTH=100% VALIGN=TOP STYLE="border: 1px solid #000000; padding: 0.04in">
			<P>sdc                           8:32   1   1.9G  0 disk 
			</P>
		</TD>
	</TR>
</TABLE>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
Na našem USB – u , kreiramo particiju /dev/sdc1. Tip Linux,
veličine 1024 MiB</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
Prikaz našeg USB – a.</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<TABLE WIDTH=100% CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=256*>
	<TR>
		<TD WIDTH=100% VALIGN=TOP STYLE="border: 1px solid #000000; padding: 0.04in">
			<P>sdc                                8:32   1     1.9G  0 disk  
			</P>
			<P>└─sdc1                        8:33   1     1G  0 part 
			</P>
		</TD>
	</TR>
</TABLE>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
Kreiramo LUKS particiju, koja će biti tipa1.</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<TABLE WIDTH=100% CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=256*>
	<TR>
		<TD WIDTH=100% VALIGN=TOP STYLE="border: 1px solid #000000; padding: 0.04in">
			<P># cryptsetup -y -v --type luks1 luksFormat /dev/sdc1</P>
			<P><BR>
			</P>
			<P>WARNING!</P>
			<P>========</P>
			<P>This will overwrite data on /dev/sdc1 irrevocably.</P>
			<P><BR>
			</P>
			<P>Are you sure? (Type uppercase yes): <B>YES</B></P>
			<P>Enter passphrase for /dev/sdc1: <B>Unesite zaporku ovdje -
			Enter</B><B> </B>
			</P>
			<P>Verify passphrase: <B>Ponovite zaporku ovdje - Enter</B></P>
			<P>Key slot 0 created.</P>
			<P>Command successful.</P>
		</TD>
	</TR>
</TABLE>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
Otvaramo LUKS Particiju I postavljamo ime kao I prije “secret”.</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<TABLE WIDTH=100% CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=256*>
	<TR>
		<TD WIDTH=100% VALIGN=TOP STYLE="border: 1px solid #000000; padding: 0.04in">
			<P># cryptsetup luksOpen /dev/sdc1 secret</P>
			<P> 
			</P>
			<P>Enter passphrase for /dev/sdc1: 
			</P>
		</TD>
	</TR>
</TABLE>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
Kreiramo file-system. Ovaj put izabiremo xfs file system.</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<TABLE WIDTH=100% CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=256*>
	<TR>
		<TD WIDTH=100% VALIGN=TOP STYLE="border: 1px solid #000000; padding: 0.04in">
			<P># mkfs.xfs /dev/mapper/secret</P>
			<P><BR>
			</P>
			<P>meta-data=/dev/mapper/secret     isize=512    agcount=4,
			agsize=65408 blks</P>
			<P>         =                       sectsz=512   attr=2,
			projid32bit=1</P>
			<P>         =                       crc=1        finobt=1,
			sparse=1, rmapbt=0</P>
			<P>         =                       reflink=1</P>
			<P>data     =                       bsize=4096   blocks=261632,
			imaxpct=25</P>
			<P>         =                       sunit=0      swidth=0 blks</P>
			<P>naming   =version 2              bsize=4096   ascii-ci=0,
			ftype=1</P>
			<P>log      =internal log           bsize=4096   blocks=1566,
			version=2</P>
			<P>         =                       sectsz=512   sunit=0 blks,
			lazy-count=1</P>
			<P>realtime =none                   extsz=4096   blocks=0,
			rtextents=0</P>
		</TD>
	</TR>
</TABLE>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
Provjera statusa:</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<TABLE WIDTH=100% CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=256*>
	<TR>
		<TD WIDTH=100% VALIGN=TOP STYLE="border: 1px solid #000000; padding: 0.04in">
			<P># cryptsetup status secret</P>
			<P><BR>
			</P>
			<P>/dev/mapper/secret is active.</P>
			<P>  <B>type:    LUKS1</B></P>
			<P>  cipher:  aes-xts-plain64</P>
			<P>  keysize: 512 bits</P>
			<P>  key location: dm-crypt</P>
			<P>  device:  /dev/sdc1</P>
			<P>  sector size:  512</P>
			<P>  offset:  4096 sectors</P>
			<P>  size:    2093056 sectors</P>
			<P>  mode:    read/write</P>
		</TD>
	</TR>
</TABLE>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
Uređujemo file <B>/etc/crypttab</B></P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
Nalazimo UUID od particije <B>/dev/sdc1</B></P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<TABLE WIDTH=100% CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=256*>
	<TR>
		<TD WIDTH=100% VALIGN=TOP STYLE="border: 1px solid #000000; padding: 0.04in">
			<P>[root@peric ~]# blkid /dev/sdc1</P>
			<P>/dev/sdc1: <B>UUID=&quot;cb63582b-4442-4a90-9aa6-2bf44c22d119&quot;</B>
			TYPE=&quot;crypto_LUKS&quot; PARTUUID=&quot;912c0800-01&quot;</P>
		</TD>
	</TR>
</TABLE>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
Uređujemo file <B>/</B><B>etc/crypttab</B>: 
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<TABLE WIDTH=100% CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=256*>
	<TR>
		<TD WIDTH=100% VALIGN=TOP STYLE="border: 1px solid #000000; padding: 0.04in">
			<P># vim /etc/crypttab</P>
		</TD>
	</TR>
</TABLE>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
Sa sadržajem koji može biti :</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<TABLE WIDTH=100% CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=256*>
	<TR>
		<TD WIDTH=100% VALIGN=TOP STYLE="border: 1px solid #000000; padding: 0.04in">
			<P>secret UUID=cb63582b-4442-4a90-9aa6-2bf44c22d119 none</P>
		</TD>
	</TR>
</TABLE>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
ili</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<TABLE WIDTH=100% CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=256*>
	<TR>
		<TD WIDTH=100% VALIGN=TOP STYLE="border: 1px solid #000000; padding: 0.04in">
			<P>secret UUID=cb63582b-4442-4a90-9aa6-2bf44c22d119 none luks ←
			preporuka</P>
		</TD>
	</TR>
</TABLE>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
Ili možemo unijeti ovako:</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<TABLE WIDTH=100% CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=256*>
	<TR>
		<TD WIDTH=100% VALIGN=TOP STYLE="border: 1px solid #000000; padding: 0.04in">
			<P>secret /dev/sdc1 none</P>
		</TD>
	</TR>
</TABLE>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<TABLE WIDTH=100% CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=256*>
	<TR>
		<TD WIDTH=100% VALIGN=TOP STYLE="border: 1px solid #000000; padding: 0.04in">
			<P>secret dev/sdc1 none luks</P>
		</TD>
	</TR>
</TABLE>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
Izmjena  <B>/</B><B>etc/</B><B>fstab </B>file – a, gdje  dodajemo:</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<TABLE WIDTH=100% CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=256*>
	<TR>
		<TD WIDTH=100% VALIGN=TOP STYLE="border: 1px solid #000000; padding: 0.04in">
			<P>/dev/mapper/secret /mnt/secret xfs defaults 0 0</P>
		</TD>
	</TR>
</TABLE>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
Već imamo kreirani direktorij gdje učitamo LUKS particiju:
/mnt/secret</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<TABLE WIDTH=100% CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=256*>
	<TR>
		<TD WIDTH=100% VALIGN=TOP STYLE="border: 1px solid #000000; padding: 0.04in">
			<P># mount -v /dev/mapper/secret /mnt/secret</P>
			<P><BR>
			</P>
			<P>mount: /mnt/secret does not contain SELinux labels.</P>
			<P>       You just mounted an file system that supports labels
			which does not</P>
			<P>       contain labels, onto an SELinux box. It is likely that
			confined</P>
			<P>       applications will generate AVC messages and not be
			allowed access to</P>
			<P>       this file system.  For more details see restorecon(8)
			and mount(8).</P>
			<P>mount: /dev/mapper/secret mounted on /mnt/secret.</P>
			<P><BR>
			</P>
			<P># restorecon -vvRF /mnt/secret</P>
			<P>Relabeled /mnt/secret from system_u:object_r:unlabeled_t:s0 to
			system_u:object_r:mnt_t:s0</P>
			<P><BR>
			</P>
			<P># mount -v -o remount /dev/mapper/secret /mnt/secret</P>
			<P>mount: /dev/mapper/secret mounted on /mnt/secret.</P>
		</TD>
	</TR>
</TABLE>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
Preporučena naredba pri izmjeni /etc/fstab file – a. 
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<TABLE WIDTH=100% CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=256*>
	<TR>
		<TD WIDTH=100% VALIGN=TOP STYLE="border: 1px solid #000000; padding: 0.04in">
			<P># mount -av</P>
			<P>/                        : ignored</P>
			<P>/boot                    : already mounted</P>
			<P>swap                     : ignored</P>
			<P>/mnt/secret              : already mounted</P>
		</TD>
	</TR>
</TABLE>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
I sad možem reboot sustav, I kod boot menu – a (malo poslje),
prikazat će nam se poruka gdje će nas pitati da unesemo passpharse
za /secret. Kad je unesemo sustav se normalno pokreće.</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
Dodatno:</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
Ovdje možemo I na ovaj način uredit /etc/fstab file</P>
<P STYLE="margin-bottom: 0in; font-weight: normal; line-height: 100%">
<BR>
</P>
<TABLE WIDTH=100% CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=256*>
	<TR>
		<TD WIDTH=100% VALIGN=TOP STYLE="border: 1px solid #000000; padding: 0.04in">
			<P>/dev/mapper/secret /secret xfs defaults 1 2 
			</P>
		</TD>
	</TR>
</TABLE>
<P STYLE="margin-bottom: 0in; line-height: 100%; text-decoration: none">
<BR>
</P>
</BODY>
<hr style="color:#ffb380">
<center><p><a href="kre_luks_pr_2.html">Prethodna</a> | <a href=".html">Sljedeća</a></center> 
<hr style="color:#ffb380">
</HTML>
